<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <% @logo = Picture.find_by_name('logo') %>
  <link rel="shortcut icon" href=<%= !(@logo.nil? || @logo.picture_path.blank?) ? url_for_file_column(@logo, 'picture_path', 'favicon') : "/images/favicon.ico" %>/>

  <%= stylesheet_link_tag "application.css" %>
  <%= stylesheet_link_tag "form.css" %>
  <%= stylesheet_link_tag "starbox.css" %>
  <%= stylesheet_link_tag "middle.css" %>
  <%= stylesheet_link_tag "colorPicker.css" %>
  
  <%#= javascript_include_tag :all %>
  <script type="text/javascript" src="/javascripts/prototype.js"></script>
  <script type="text/javascript" src="/javascripts/scriptaculous.js"></script>
  <script type="text/javascript" src="/fckeditor/fckeditor.js"></script>
  <script type="text/javascript" src="/javascripts/starbox.js"></script>
  <script type="text/javascript" src="/javascripts/enhance.js"></script>
  <script type="text/javascript" src="/javascripts/colorPicker.js"></script>
  
  <%#= calendar_date_select_includes nil %>
  <title>
    <%= I18n.t 'layout.title' %> - 
    <%= params[:action].capitalize if params[:action] != 'index' %>
    <%= params[:controller].capitalize %>
  </title>
</head>

<body onload="initialize()">
<div id="page">
  <div id="header">
    <div id="logo">
			<% if !(@logo.nil? || @logo.picture_path.blank?) %>
				<%= link_to image_tag(url_for_file_column(@logo, 'picture_path', 'normal')), "/" %>
			<% else %>
				<%= link_to(image_tag('logo.png', :width => '400', :height => '80', :border => 0), "/") %>
			<%end %>
    </div>
    <div id="header_right">
      <div id="main_links">
        <%= I18n.t('layout.welcome_message') %>
        <%= @current_user.firstname.capitalize %> |
        <%= link_to I18n.t('layout.account_access'), user_path(current_user) %> |
        <%= link_to I18n.t('layout.administration'), administration_user_path(current_user) %> |
		<% if current_user.is_superadmin? %>
          <%= link_to I18n.t('layout.superadministration'), superadministration_path("default") %> |
		<% end %>
        <%= link_to I18n.t('layout.logout'), '/logout' %>
		<%= link_to_remote image_tag('countries/en.jpg'), :url => change_language_session_path(:locale => "en-US") %> 
		<%= link_to_remote image_tag('countries/es.jpg'), :url => change_language_session_path(:locale => "es-ES") %> 	
		<%= link_to_remote image_tag('countries/fr.jpg'), :url => change_language_session_path(:locale => "fr-FR") %>
      </div>
      <div id="MenuHR">
        <ul>
          <li>
            <%= link_to I18n.t('layout.first_page'), '/' %>
          </li>
          <li>
            <%= link_to I18n.t('layout.content'), content_path("articles") %>
          </li>
          <li>
            <%= link_to I18n.t('layout.administration'), administration_user_path(current_user) %>
          </li>
        </ul>
        <div id="slct_WS">
          <select name="slct_WS" onchange="document.location.href = this.value">
            <option>
              <%= I18n.t('layout.workspaces') %>
            </option>
            <option>
              ----------
            </option>
            <% (Workspace.administrated_by(@current_user) + Workspace.consulted_by(@current_user)).each do |w| %>
              <%= content_tag(:option, w.name, :value => workspace_path(w)) %>
            <% end %>
            <option>
              ----------
            </option>
            <option value="<%= administration_user_path(current_user) %>#new_workspace">
              <%= I18n.t('layout.new_workspace') %>
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <div id="container">
    <div id="middle-right">
      <h3>
        <%= I18n.t('layout.add_content') %>
      </h3>
      <form name="form1" method="post" action="" id="form1">
        <select name="slct_filtre" id="slct_filtre" onchange="document.location.href = this.value">
          <option selected="selected" value='#'>
            --------
          </option>
          <option value="<%= new_item_path(Article) %>">
            <%= I18n.t 'layout.article' %>
          </option>
          <option value="<%= new_item_path(Image) %>">
            <%= I18n.t 'layout.image' %>
          </option>
          <option value="<%= new_item_path(Audio) %>">
            <%= I18n.t 'layout.audio' %>
          </option>
          <option value="<%= new_item_path(Video) %>">
            <%= I18n.t 'layout.video' %>
          </option>
          <option value="<%= new_item_path(ArticFile) %>">
            <%= I18n.t 'layout.file' %>
          </option>
          <option value="<%= new_item_path(Publication) %>">
            <%= I18n.t 'layout.publication' %>
          </option>
          <option value="<%= new_item_path(FeedSource) %>">
            <%= I18n.t 'layout.feed_source' %>
          </option>
          <option value="<%= new_item_path(Link) %>">
            <%= I18n.t 'layout.link' %>
          </option>
        </select>
      </form>
    </div>
    <div id="middle-middle">
      <% unless @hide_full_text_search %>
        <div id="search-bar-container">
          <div id="search-bar-left"></div>
          <div id="search-bar-middle">
            <% form_tag search_path, :method => :get, :name => "search" do -%>
              <%= text_field_tag :search, params[:search] || "Rechercher", :class => "style_text", :onfocus => '$(this).select()' %>
              <p>dans</p>
              <%= select_tag "model", options_for_select([['Tous les éléments', nil], ['Images', 'Image'], ['Videos', 'Video'], ['Fichiers', 'ArticFile'], ['Articles', 'Article'], ['Publications', 'Publication'], ['Fichiers audios', 'Audio']], params['model']) %>
              <%= link_to(image_tag("search_button.gif"), "javascript:void(1);", :onclick => "document.search.submit();", :class => "search_button") %>
              <br />
              <%= link_to 'Recherche avancée', new_search_path, :class => "advanced_search" %>&nbsp;&nbsp;
            <% end -%>
          </div>
          <div id="search-bar-right"></div>
          <div class="clear"></div>
        </div>
      <% end %>
      <%= content_tag(:div, flash[:notice], :class => 'notice') if flash[:notice] %>
      <%= content_tag(:div, flash[:error], :class => 'error') if flash[:error] %>
      <%= yield %>
      <div id="spinner" style="display:none;">
        <center>
          <%= image_tag 'spinner.gif', :width => '40', :height => '15' %><br />
          <b>L O A D I N G</b>
        </center>
      </div>
    </div>
    <div id="footer">
      <div class="name">
        <%=  I18n.t 'layout.footer_title' %>
      </div>
      <div class="menu">
        <%= link_to I18n.t('layout.contact'), "#" %>&nbsp;|&nbsp;
        <%= link_to I18n.t('layout.map'), "#" %>&nbsp;|&nbsp;
        <%= link_to I18n.t('layout.faq'), "#" %>
      </div>
      <div class="clear"></div>
    </div>
  </div>
</div>
