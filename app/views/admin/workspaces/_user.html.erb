<% new_or_existing = user.new_record? ? 'new' : 'existing' %>
<% prefix = "workspace[#{new_or_existing}_user_attributes][]" %>
<table>
	<% fields_for prefix, user do |user_form| -%>
	<tr>
		<td><%= label_tag :role_id, object.user.login, :class => "userName" %></td>
		<td>
			<div id="workspace_user_<%= object.user.login %>">
    	
    	
      		<%= user_form.select :role_id,
	        					 Role.find(:all,
	        					 :conditions => {:type_role => 'workspace'}).collect { |r| 							
												[I18n.t('general.role.'+r.name), r.id] } %>
	      	
			<%= user_form.hidden_field :user_id, :value => object.user.id %>
      		
			<%= link_to_function I18n.t('general.button.delete'), 
								 "$('#workspace_user_#{object.user.login}').remove()" %>
		
  			</div>
		</td>
	</tr>
	<% end -%>
</table>